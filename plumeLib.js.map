{"version":3,"file":null,"sources":["../bare-bones-logger/src/logger/setup.js","../bare-bones-logger/src/index.js","src/index.js"],"sourcesContent":["var send = null;\r\n\r\nfunction mangle(name) {\r\n  return \"_\" + name;\r\n}\r\n\r\nfunction wrap(name) {\r\n  var orig = name;\r\n  while (console[orig]) {\r\n    orig = mangle(orig);\r\n  }\r\n  console[orig] = console[name];\r\n  return function () {\r\n    var args = [];\r\n    for (var i = 0; i < arguments.length; ++i) {\r\n      var elem = arguments[i];\r\n      if (typeof elem === \"object\" && !(elem instanceof String)) {\r\n        var obj1 = elem,\r\n          obj2 = {};\r\n        for (var key in obj1) {\r\n          obj2[key] = obj1[key];\r\n          if (obj2[key] !== null && obj2[key] !== undefined) {\r\n            obj2[key] = obj2[key].toString();\r\n          }\r\n        }\r\n        args.push(obj2);\r\n      }\r\n      else if(elem) {\r\n        args.push(elem.toString());\r\n      }\r\n      else{\r\n        args.push(\"null\");\r\n      }\r\n    }\r\n    var obj = send({\r\n      name,\r\n      args\r\n    });\r\n    if (obj) {\r\n      console[orig].apply(console, arguments);\r\n    }\r\n  };\r\n}\r\n\r\nfunction onError(message, source, lineno, colno, error) {\r\n  colno = colno || window.event && window.event.errorCharacter;\r\n  var done = false,\r\n    name = \"error\",\r\n    stack = error && error.stack;\r\n\r\n  if(!stack){\r\n    if(arguments.callee){\r\n      var head = arguments.callee.caller;\r\n      while(head){\r\n        stack.push(head.name);\r\n        head = head.caller;\r\n      }\r\n    }\r\n    else{\r\n      stack = \"N/A\";\r\n    }\r\n  }\r\n\r\n  var data = {\r\n      type: \"error\",\r\n      time: (new Date())\r\n        .toLocaleTimeString(),\r\n      message: message,\r\n      source: source,\r\n      lineno: lineno,\r\n      colno: colno,\r\n      error: error.message,\r\n      stack: stack\r\n    };\r\n\r\n  while (!done && console[name]) {\r\n    try {\r\n      console[name](data);\r\n      done = true;\r\n    }\r\n    catch (exp) {\r\n      name = mangle(name);\r\n    }\r\n  }\r\n}\r\n\r\nexport default function setup(type, target, redirects) {\r\n  if (type !== logger.DISABLED) {\r\n    if ((type === logger.HTTP || type === logger.WEBSOCKET) && location.protocol === \"file:\") {\r\n      console.warn(\"Can't perform HTTP requests from the file system. Not going to setup the error proxy, but will setup the error catch-all.\");\r\n    }\r\n    else if (type === logger.HTTP) {\r\n      send = function (data) {\r\n        var req = new XMLHttpRequest();\r\n        req.open(\"POST\", target);\r\n        req.setRequestHeader(\"Content-Type\", \"application/json;charset=UTF-8\");\r\n        req.send(JSON.stringify(data));\r\n        return data;\r\n      };\r\n    }\r\n    else if (type === logger.WEBSOCKET) {\r\n      var socket = new WebSocket(target);\r\n      send = function (data) {\r\n        socket.send(JSON.stringify(data));\r\n        return data;\r\n      };\r\n    }\r\n    else if (type === logger.DOM) {\r\n      var output = document.querySelector(target);\r\n      send = function (data) {\r\n        var elem = document.createElement(\"pre\");\r\n        elem.appendChild(document.createTextNode(JSON.stringify(data)));\r\n        output.appendChild(elem);\r\n        return data;\r\n      };\r\n    }\r\n    else if (type === logger.USER) {\r\n      if (!(target instanceof Function)) {\r\n        console.warn(\"The target parameter was expected to be a function, but it was\", target);\r\n      }\r\n      else {\r\n        send = target;\r\n      }\r\n    }\r\n\r\n    if (send !== null) {\r\n      redirects = redirects || [\"log\", \"info\", \"error\"];\r\n      redirects.forEach(function (n) {\r\n        console[n] = wrap(n);\r\n      });\r\n    }\r\n\r\n    window.addEventListener(\"error\", function(evt){\r\n      onError(evt.message, evt.filename, evt.lineno, evt.colno, evt.error);\r\n    }, false);\r\n  }\r\n}","import setup from \"./logger/setup\";\r\nexport default logger = {\r\n  setup,\r\n  DISABLED: 0,\r\n  HTTP: 1,\r\n  WEBSOCKET: 2,\r\n  DOM: 3,\r\n  USER: 4\r\n};\r\n","import logger from \"../../bare-bones-logger/src\";\r\n\r\nWebVRStandardMonitor();\r\n\r\nprog.bar.style.height = \"10px\";\r\n\r\nvar ctrls = Primrose.DOM.findEverything(),\r\n  loginControls = [\r\n    ctrls.userName,\r\n    ctrls.connect\r\n  ],\r\n  names = NameGen.compile(\"!mi\"),\r\n  protocol = location.protocol.replace(\"http\", \"ws\"),\r\n  serverPath = protocol + \"//\" + location.hostname,\r\n  roomPattern = /\\broom=(\\w+)/,\r\n  userPattern = /\\buser=(\\w+)/,\r\n  defaultRoomName = null,\r\n  defaultUserName = null,\r\n  socket = null,\r\n  session = null,\r\n  publisher = null,\r\n\r\n  app = new Primrose.BrowserEnvironment({\r\n    useFog: false,\r\n    useGaze: true,\r\n    quality: Quality.HIGH,\r\n    groundTexture: 0x000000,\r\n    backgroundColor: 0x000000,\r\n    sceneModel: \"models/meeting/meetingroom.obj\",\r\n    avatarModel: \"models/avatar.json\",\r\n    font: \"fonts/helvetiker_regular.typeface.json\",\r\n    disableWebRTC: true,\r\n    progress: prog.thunk\r\n  });\r\n\r\nctrls.closeButton.addEventListener(\"click\", hideLoginForm, false);\r\nctrls.userName.addEventListener(\"keyup\", authenticate, false);\r\nctrls.connect.addEventListener(\"click\", authenticate, false);\r\nctrls.randomRoomName.addEventListener(\"click\", setRoomName, false);\r\nctrls.randomUserName.addEventListener(\"click\", setUserName, false);\r\nctrls.roomName.addEventListener(\"change\", setRoomName, false);\r\nctrls.userName.addEventListener(\"change\", setUserName, false);\r\n\r\nwindow.addEventListener(\"popstate\", setRoomName);\r\napp.addEventListener(\"ready\", environmentReady);\r\n\r\nsetRoomName({ state: {\r\n  roomName: fromField(location.search, roomPattern) || fromField(document.cookie, roomPattern)\r\n}});\r\n\r\nsetUserName({ state: {\r\n  userName: fromField(location.search, userPattern) || fromField(document.cookie, userPattern)\r\n}});\r\n\r\nfunction setRoomName(evt) {\r\n  defaultRoomName = evt && evt.state && evt.state.roomName;\r\n  if(defaultRoomName){\r\n    evt = evt || true;\r\n    ctrls.roomName.value = defaultRoomName;\r\n  }\r\n  else if(evt.type === \"change\"){\r\n    defaultRoomName = ctrls.roomName.value;\r\n  }\r\n  else {\r\n    defaultRoomName = names.toString();\r\n    ctrls.roomName.placeholder = defaultRoomName + \" (random)\";\r\n    ctrls.roomName.value = \"\";\r\n  }\r\n  if(evt && evt.type !== \"popstate\"){\r\n    history.pushState({ roomName: defaultRoomName }, \"Room ID: \" + defaultRoomName, \"?room=\" + defaultRoomName);\r\n  }\r\n}\r\n\r\nfunction setUserName(evt) {\r\n  defaultUserName = evt && evt.state && evt.state.userName;\r\n  if(defaultUserName){\r\n    ctrls.userName.value = defaultUserName;\r\n  }\r\n  else if(evt.type === \"change\"){\r\n    defaultUserName = ctrls.userName.value;\r\n  }\r\n  else{\r\n    defaultUserName = names.toString();\r\n    ctrls.userName.placeholder = defaultUserName + \" (random)\";\r\n    ctrls.userName.value = \"\";\r\n  }\r\n}\r\n\r\nfunction getRoomName() {\r\n  return ctrls.roomName.value || defaultRoomName;\r\n}\r\n\r\nfunction getUserName() {\r\n  return ctrls.userName.value || defaultUserName;\r\n}\r\n\r\nfunction fromField(field, pattern) {\r\n  var spec = field.match(pattern);\r\n  return spec && spec[1];\r\n}\r\n\r\nfunction hideLoginForm(evt) {\r\n  ctrls.loginForm.style.display = \"none\";\r\n  ctrls.frontBuffer.focus();\r\n}\r\n\r\nfunction showLoginForm() {\r\n  ctrls.loginForm.style.display = \"\";\r\n  ctrls.userName.focus();\r\n}\r\n\r\nfunction errorMessage(message) {\r\n  ctrls.errorMessage.innerHTML = message;\r\n  ctrls.errorMessage.style.display = \"block\";\r\n  showLoginForm();\r\n  disableLogin(false);\r\n}\r\n\r\nfunction disableLogin(v) {\r\n  loginControls.forEach((ctrl) => ctrl.disabled = v);\r\n  document.body.style.cursor = v ? \"wait\" : \"\";\r\n}\r\n\r\nfunction environmentReady() {\r\n  prog.bar.style.display = \"none\";\r\n  ctrls.loginForm.style.display = \"\";\r\n\r\n  window.addEventListener(\"vrdisplaypresentchange\", () => {\r\n    const currDev = app.input.VR.currentDevice;\r\n    ctrls.controls.style.display = currDev && currDev.isPresenting ? \"none\" : \"\";\r\n  });\r\n\r\n  app.insertFullScreenButtons(\"#fullScreenButtonContainer\")\r\n    .forEach((btn) => btn.className = \"primary\");\r\n}\r\n\r\nfunction authenticate(evt) {\r\n  if (!evt || evt.type !== \"keyup\" || evt.keyCode === Primrose.Keys.ENTER) {\r\n\r\n    disableLogin(true);\r\n\r\n    if (!socket) {\r\n      console.log(\"connecting to: %s\", serverPath);\r\n      socket = io(serverPath);\r\n      socket.on(\"connect_error\", connectionError);\r\n      socket.on(\"reconnect\", authenticate);\r\n      socket.on(\"loginFailed\", authFailed);\r\n      socket.on(\"loginComplete\", authSucceeded);\r\n      socket.on(\"errorDetail\", console.error.bind(console));\r\n    }\r\n\r\n    socket.emit(\"guest\", {\r\n      userName: getUserName(),\r\n      appKey: getRoomName()\r\n    });\r\n  }\r\n}\r\n\r\nfunction connectionError(evt) {\r\n  socket.close();\r\n  socket = null;\r\n  app.disconnect();\r\n  authFailed(\"an error occured while connecting to the server.\");\r\n}\r\n\r\nfunction authFailed(reason) {\r\n  errorMessage(\"We couldn't log you in right now because \" + reason.replace(/\\[USER\\]/g, ctrls.userName.value));\r\n}\r\n\r\nfunction authSucceeded() {\r\n  ctrls.errorMessage.innerHTML = \"\";\r\n  ctrls.errorMessage.style.display = \"none\";\r\n  disableLogin(false);\r\n  hideLoginForm();\r\n  var userName = getUserName(),\r\n      roomName = getRoomName();\r\n  document.cookie = \"room=\" + encodeURI(roomName) + \"&user=\" + encodeURI(userName);\r\n  app.connect(socket, userName);\r\n  document.title = userName + \" in \" + roomName;\r\n\r\n  Primrose.HTTP.getObject(\"/tokbox/?room=\" + encodeURI(roomName) + \"&user=\" + encodeURI(userName)).then((cred) => {\r\n    session = OT.initSession(cred.apiKey, cred.sessionId);\r\n    console.log(\"session\", session);\r\n    session.on(\"streamCreated\", (evt) => {\r\n      var newUserName = evt.stream.connection.data;\r\n      session.subscribe(evt.stream, \"tokbox\", {\r\n        subscribeToAudio: true,\r\n        subscribeToVideo: false,\r\n        insertMode: \"append\"\r\n      }, (err, evt) => {\r\n        if(err){\r\n          console.error(\"tokbox stream error\", error);\r\n        }\r\n        else{\r\n          var vid = evt.element.querySelector(\"video\");\r\n          console.log(newUserName, vid);\r\n          app.setAudioFromUser(newUserName, vid);\r\n        }\r\n      });\r\n    });\r\n\r\n    session.connect(cred.token, (error) => {\r\n      if (error) {\r\n        console.error(\"tokbox connect error\", error);\r\n      } else {\r\n        publisher = OT.initPublisher(\"tokbox\", {\r\n          publishAudio: true,\r\n          publishVideo: false,\r\n          videoSource: null,\r\n          name: userName,\r\n          style: {\r\n            nameDisplay: \"off\",\r\n            buttonDisplayMode: \"off\",\r\n            showControls: false\r\n          }\r\n        });\r\n        session.publish(publisher);\r\n      }\r\n    });\r\n  });\r\n}"],"names":["send","mangle","name","wrap","orig","console","args","i","arguments","length","elem","String","obj1","obj2","key","undefined","toString","push","obj","apply","onError","message","source","lineno","colno","error","window","event","errorCharacter","done","stack","callee","head","caller","data","Date","toLocaleTimeString","exp","setup","type","target","redirects","logger","DISABLED","HTTP","WEBSOCKET","location","protocol","warn","req","XMLHttpRequest","open","setRequestHeader","JSON","stringify","socket","WebSocket","DOM","output","document","querySelector","createElement","appendChild","createTextNode","USER","Function","forEach","n","addEventListener","evt","filename","WebVRStandardMonitor","prog","bar","style","height","ctrls","Primrose","findEverything","loginControls","userName","connect","names","NameGen","compile","replace","serverPath","hostname","roomPattern","userPattern","defaultRoomName","defaultUserName","session","publisher","app","BrowserEnvironment","Quality","HIGH","thunk","closeButton","hideLoginForm","authenticate","randomRoomName","setRoomName","randomUserName","setUserName","roomName","environmentReady","state","fromField","search","cookie","value","placeholder","pushState","getRoomName","getUserName","field","pattern","spec","match","loginForm","display","frontBuffer","focus","showLoginForm","errorMessage","innerHTML","disableLogin","v","ctrl","disabled","body","cursor","currDev","input","VR","currentDevice","controls","isPresenting","insertFullScreenButtons","btn","className","keyCode","Keys","ENTER","log","io","on","connectionError","authFailed","authSucceeded","bind","emit","close","disconnect","reason","encodeURI","title","getObject","then","cred","OT","initSession","apiKey","sessionId","newUserName","stream","connection","subscribe","err","vid","element","setAudioFromUser","token","initPublisher","publish"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,IAAIA,OAAO,IAAX;;AAEA,SAASC,MAAT,CAAgBC,IAAhB,EAAsB;SACb,MAAMA,IAAb;;;AAGF,SAASC,IAAT,CAAcD,IAAd,EAAoB;MACdE,OAAOF,IAAX;SACOG,QAAQD,IAAR,CAAP,EAAsB;WACbH,OAAOG,IAAP,CAAP;;UAEMA,IAAR,IAAgBC,QAAQH,IAAR,CAAhB;SACO,YAAY;QACbI,OAAO,EAAX;SACK,IAAIC,IAAI,CAAb,EAAgBA,IAAIC,UAAUC,MAA9B,EAAsC,EAAEF,CAAxC,EAA2C;UACrCG,OAAOF,UAAUD,CAAV,CAAX;UACI,QAAOG,IAAP,yCAAOA,IAAP,OAAgB,QAAhB,IAA4B,EAAEA,gBAAgBC,MAAlB,CAAhC,EAA2D;YACrDC,OAAOF,IAAX;YACEG,OAAO,EADT;aAEK,IAAIC,GAAT,IAAgBF,IAAhB,EAAsB;eACfE,GAAL,IAAYF,KAAKE,GAAL,CAAZ;cACID,KAAKC,GAAL,MAAc,IAAd,IAAsBD,KAAKC,GAAL,MAAcC,SAAxC,EAAmD;iBAC5CD,GAAL,IAAYD,KAAKC,GAAL,EAAUE,QAAV,EAAZ;;;aAGCC,IAAL,CAAUJ,IAAV;OATF,MAWK,IAAGH,IAAH,EAAS;aACPO,IAAL,CAAUP,KAAKM,QAAL,EAAV;OADG,MAGD;aACGC,IAAL,CAAU,MAAV;;;QAGAC,MAAMlB,KAAK;gBAAA;;KAAL,CAAV;QAIIkB,GAAJ,EAAS;cACCd,IAAR,EAAce,KAAd,CAAoBd,OAApB,EAA6BG,SAA7B;;GA3BJ;;;AAgCF,SAASY,OAAT,CAAiBC,OAAjB,EAA0BC,MAA1B,EAAkCC,MAAlC,EAA0CC,KAA1C,EAAiDC,KAAjD,EAAwD;UAC9CD,SAASE,OAAOC,KAAP,IAAgBD,OAAOC,KAAP,CAAaC,cAA9C;MACIC,OAAO,KAAX;MACE3B,OAAO,OADT;MAEE4B,QAAQL,SAASA,MAAMK,KAFzB;;MAIG,CAACA,KAAJ,EAAU;QACLtB,UAAUuB,MAAb,EAAoB;UACdC,OAAOxB,UAAUuB,MAAV,CAAiBE,MAA5B;aACMD,IAAN,EAAW;cACHf,IAAN,CAAWe,KAAK9B,IAAhB;eACO8B,KAAKC,MAAZ;;KAJJ,MAOI;cACM,KAAR;;;;MAIAC,OAAO;UACD,OADC;UAEA,IAAIC,IAAJ,EAAD,CACHC,kBADG,EAFC;aAIEf,OAJF;YAKCC,MALD;YAMCC,MAND;WAOAC,KAPA;WAQAC,MAAMJ,OARN;WASAS;GATX;;SAYO,CAACD,IAAD,IAASxB,QAAQH,IAAR,CAAhB,EAA+B;QACzB;cACMA,IAAR,EAAcgC,IAAd;aACO,IAAP;KAFF,CAIA,OAAOG,GAAP,EAAY;aACHpC,OAAOC,IAAP,CAAP;;;;;AAKN,AAAe,SAASoC,KAAT,CAAeC,IAAf,EAAqBC,MAArB,EAA6BC,SAA7B,EAAwC;MACjDF,SAASG,OAAOC,QAApB,EAA8B;QACxB,CAACJ,SAASG,OAAOE,IAAhB,IAAwBL,SAASG,OAAOG,SAAzC,KAAuDC,SAASC,QAAT,KAAsB,OAAjF,EAA0F;cAChFC,IAAR,CAAa,2HAAb;KADF,MAGK,IAAIT,SAASG,OAAOE,IAApB,EAA0B;aACtB,cAAUV,IAAV,EAAgB;YACjBe,MAAM,IAAIC,cAAJ,EAAV;YACIC,IAAJ,CAAS,MAAT,EAAiBX,MAAjB;YACIY,gBAAJ,CAAqB,cAArB,EAAqC,gCAArC;YACIpD,IAAJ,CAASqD,KAAKC,SAAL,CAAepB,IAAf,CAAT;eACOA,IAAP;OALF;KADG,MASA,IAAIK,SAASG,OAAOG,SAApB,EAA+B;UAC9BU,SAAS,IAAIC,SAAJ,CAAchB,MAAd,CAAb;aACO,cAAUN,IAAV,EAAgB;eACdlC,IAAP,CAAYqD,KAAKC,SAAL,CAAepB,IAAf,CAAZ;eACOA,IAAP;OAFF;KAFG,MAOA,IAAIK,SAASG,OAAOe,GAApB,EAAyB;UACxBC,SAASC,SAASC,aAAT,CAAuBpB,MAAvB,CAAb;aACO,cAAUN,IAAV,EAAgB;YACjBxB,OAAOiD,SAASE,aAAT,CAAuB,KAAvB,CAAX;aACKC,WAAL,CAAiBH,SAASI,cAAT,CAAwBV,KAAKC,SAAL,CAAepB,IAAf,CAAxB,CAAjB;eACO4B,WAAP,CAAmBpD,IAAnB;eACOwB,IAAP;OAJF;KAFG,MASA,IAAIK,SAASG,OAAOsB,IAApB,EAA0B;UACzB,EAAExB,kBAAkByB,QAApB,CAAJ,EAAmC;gBACzBjB,IAAR,CAAa,gEAAb,EAA+ER,MAA/E;OADF,MAGK;eACIA,MAAP;;;;QAIAxC,SAAS,IAAb,EAAmB;kBACLyC,aAAa,CAAC,KAAD,EAAQ,MAAR,EAAgB,OAAhB,CAAzB;gBACUyB,OAAV,CAAkB,UAAUC,CAAV,EAAa;gBACrBA,CAAR,IAAahE,KAAKgE,CAAL,CAAb;OADF;;;WAKKC,gBAAP,CAAwB,OAAxB,EAAiC,UAASC,GAAT,EAAa;cACpCA,IAAIhD,OAAZ,EAAqBgD,IAAIC,QAAzB,EAAmCD,IAAI9C,MAAvC,EAA+C8C,IAAI7C,KAAnD,EAA0D6C,IAAI5C,KAA9D;KADF,EAEG,KAFH;;;;ACnIWiB,SAAS;cAAA;YAEZ,CAFY;QAGhB,CAHgB;aAIX,CAJW;OAKjB,CALiB;QAMhB;CANR;;ACCA6B;;AAEAC,KAAKC,GAAL,CAASC,KAAT,CAAeC,MAAf,GAAwB,MAAxB;;AAEA,IAAIC,QAAQC,SAASpB,GAAT,CAAaqB,cAAb,EAAZ;IACEC,gBAAgB,CACdH,MAAMI,QADQ,EAEdJ,MAAMK,OAFQ,CADlB;IAKEC,QAAQC,QAAQC,OAAR,CAAgB,KAAhB,CALV;IAMErC,WAAWD,SAASC,QAAT,CAAkBsC,OAAlB,CAA0B,MAA1B,EAAkC,IAAlC,CANb;IAOEC,aAAavC,WAAW,IAAX,GAAkBD,SAASyC,QAP1C;IAQEC,cAAc,cARhB;IASEC,cAAc,cAThB;IAUEC,kBAAkB,IAVpB;IAWEC,kBAAkB,IAXpB;IAYEpC,SAAS,IAZX;IAaEqC,UAAU,IAbZ;IAcEC,YAAY,IAdd;IAgBEC,MAAM,IAAIjB,SAASkB,kBAAb,CAAgC;UAC5B,KAD4B;WAE3B,IAF2B;WAG3BC,QAAQC,IAHmB;iBAIrB,QAJqB;mBAKnB,QALmB;cAMxB,gCANwB;eAOvB,oBAPuB;QAQ9B,wCAR8B;iBASrB,IATqB;YAU1BzB,KAAK0B;CAVX,CAhBR;;AA6BAtB,MAAMuB,WAAN,CAAkB/B,gBAAlB,CAAmC,OAAnC,EAA4CgC,aAA5C,EAA2D,KAA3D;AACAxB,MAAMI,QAAN,CAAeZ,gBAAf,CAAgC,OAAhC,EAAyCiC,YAAzC,EAAuD,KAAvD;AACAzB,MAAMK,OAAN,CAAcb,gBAAd,CAA+B,OAA/B,EAAwCiC,YAAxC,EAAsD,KAAtD;AACAzB,MAAM0B,cAAN,CAAqBlC,gBAArB,CAAsC,OAAtC,EAA+CmC,WAA/C,EAA4D,KAA5D;AACA3B,MAAM4B,cAAN,CAAqBpC,gBAArB,CAAsC,OAAtC,EAA+CqC,WAA/C,EAA4D,KAA5D;AACA7B,MAAM8B,QAAN,CAAetC,gBAAf,CAAgC,QAAhC,EAA0CmC,WAA1C,EAAuD,KAAvD;AACA3B,MAAMI,QAAN,CAAeZ,gBAAf,CAAgC,QAAhC,EAA0CqC,WAA1C,EAAuD,KAAvD;;AAEA/E,OAAO0C,gBAAP,CAAwB,UAAxB,EAAoCmC,WAApC;AACAT,IAAI1B,gBAAJ,CAAqB,OAArB,EAA8BuC,gBAA9B;;AAEAJ,YAAY,EAAEK,OAAO;cACTC,UAAU/D,SAASgE,MAAnB,EAA2BtB,WAA3B,KAA2CqB,UAAUlD,SAASoD,MAAnB,EAA2BvB,WAA3B;GAD3C,EAAZ;;AAIAiB,YAAY,EAAEG,OAAO;cACTC,UAAU/D,SAASgE,MAAnB,EAA2BrB,WAA3B,KAA2CoB,UAAUlD,SAASoD,MAAnB,EAA2BtB,WAA3B;GAD3C,EAAZ;;AAIA,SAASc,WAAT,CAAqBlC,GAArB,EAA0B;oBACNA,OAAOA,IAAIuC,KAAX,IAAoBvC,IAAIuC,KAAJ,CAAUF,QAAhD;MACGhB,eAAH,EAAmB;UACXrB,OAAO,IAAb;UACMqC,QAAN,CAAeM,KAAf,GAAuBtB,eAAvB;GAFF,MAIK,IAAGrB,IAAI9B,IAAJ,KAAa,QAAhB,EAAyB;sBACVqC,MAAM8B,QAAN,CAAeM,KAAjC;GADG,MAGA;sBACe9B,MAAMlE,QAAN,EAAlB;UACM0F,QAAN,CAAeO,WAAf,GAA6BvB,kBAAkB,WAA/C;UACMgB,QAAN,CAAeM,KAAf,GAAuB,EAAvB;;MAEC3C,OAAOA,IAAI9B,IAAJ,KAAa,UAAvB,EAAkC;YACxB2E,SAAR,CAAkB,EAAER,UAAUhB,eAAZ,EAAlB,EAAiD,cAAcA,eAA/D,EAAgF,WAAWA,eAA3F;;;;AAIJ,SAASe,WAAT,CAAqBpC,GAArB,EAA0B;oBACNA,OAAOA,IAAIuC,KAAX,IAAoBvC,IAAIuC,KAAJ,CAAU5B,QAAhD;MACGW,eAAH,EAAmB;UACXX,QAAN,CAAegC,KAAf,GAAuBrB,eAAvB;GADF,MAGK,IAAGtB,IAAI9B,IAAJ,KAAa,QAAhB,EAAyB;sBACVqC,MAAMI,QAAN,CAAegC,KAAjC;GADG,MAGD;sBACgB9B,MAAMlE,QAAN,EAAlB;UACMgE,QAAN,CAAeiC,WAAf,GAA6BtB,kBAAkB,WAA/C;UACMX,QAAN,CAAegC,KAAf,GAAuB,EAAvB;;;;AAIJ,SAASG,WAAT,GAAuB;SACdvC,MAAM8B,QAAN,CAAeM,KAAf,IAAwBtB,eAA/B;;;AAGF,SAAS0B,WAAT,GAAuB;SACdxC,MAAMI,QAAN,CAAegC,KAAf,IAAwBrB,eAA/B;;;AAGF,SAASkB,SAAT,CAAmBQ,KAAnB,EAA0BC,OAA1B,EAAmC;MAC7BC,OAAOF,MAAMG,KAAN,CAAYF,OAAZ,CAAX;SACOC,QAAQA,KAAK,CAAL,CAAf;;;AAGF,SAASnB,aAAT,CAAuB/B,GAAvB,EAA4B;QACpBoD,SAAN,CAAgB/C,KAAhB,CAAsBgD,OAAtB,GAAgC,MAAhC;QACMC,WAAN,CAAkBC,KAAlB;;;AAGF,SAASC,aAAT,GAAyB;QACjBJ,SAAN,CAAgB/C,KAAhB,CAAsBgD,OAAtB,GAAgC,EAAhC;QACM1C,QAAN,CAAe4C,KAAf;;;AAGF,SAASE,YAAT,CAAsBzG,OAAtB,EAA+B;QACvByG,YAAN,CAAmBC,SAAnB,GAA+B1G,OAA/B;QACMyG,YAAN,CAAmBpD,KAAnB,CAAyBgD,OAAzB,GAAmC,OAAnC;;eAEa,KAAb;;;AAGF,SAASM,YAAT,CAAsBC,CAAtB,EAAyB;gBACT/D,OAAd,CAAsB,UAACgE,IAAD;WAAUA,KAAKC,QAAL,GAAgBF,CAA1B;GAAtB;WACSG,IAAT,CAAc1D,KAAd,CAAoB2D,MAApB,GAA6BJ,IAAI,MAAJ,GAAa,EAA1C;;;AAGF,SAAStB,gBAAT,GAA4B;OACrBlC,GAAL,CAASC,KAAT,CAAegD,OAAf,GAAyB,MAAzB;QACMD,SAAN,CAAgB/C,KAAhB,CAAsBgD,OAAtB,GAAgC,EAAhC;;SAEOtD,gBAAP,CAAwB,wBAAxB,EAAkD,YAAM;QAChDkE,UAAUxC,IAAIyC,KAAJ,CAAUC,EAAV,CAAaC,aAA7B;UACMC,QAAN,CAAehE,KAAf,CAAqBgD,OAArB,GAA+BY,WAAWA,QAAQK,YAAnB,GAAkC,MAAlC,GAA2C,EAA1E;GAFF;;MAKIC,uBAAJ,CAA4B,4BAA5B,EACG1E,OADH,CACW,UAAC2E,GAAD;WAASA,IAAIC,SAAJ,GAAgB,SAAzB;GADX;;;AAIF,SAASzC,YAAT,CAAsBhC,GAAtB,EAA2B;MACrB,CAACA,GAAD,IAAQA,IAAI9B,IAAJ,KAAa,OAArB,IAAgC8B,IAAI0E,OAAJ,KAAgBlE,SAASmE,IAAT,CAAcC,KAAlE,EAAyE;;iBAE1D,IAAb;;QAEI,CAAC1F,MAAL,EAAa;cACH2F,GAAR,CAAY,mBAAZ,EAAiC5D,UAAjC;eACS6D,GAAG7D,UAAH,CAAT;aACO8D,EAAP,CAAU,eAAV,EAA2BC,eAA3B;aACOD,EAAP,CAAU,WAAV,EAAuB/C,YAAvB;aACO+C,EAAP,CAAU,aAAV,EAAyBE,UAAzB;aACOF,EAAP,CAAU,eAAV,EAA2BG,aAA3B;aACOH,EAAP,CAAU,aAAV,EAAyB/I,QAAQoB,KAAR,CAAc+H,IAAd,CAAmBnJ,OAAnB,CAAzB;;;WAGKoJ,IAAP,CAAY,OAAZ,EAAqB;gBACTrC,aADS;cAEXD;KAFV;;;;AAOJ,SAASkC,eAAT,CAAyBhF,GAAzB,EAA8B;SACrBqF,KAAP;WACS,IAAT;MACIC,UAAJ;aACW,kDAAX;;;AAGF,SAASL,UAAT,CAAoBM,MAApB,EAA4B;eACb,8CAA8CA,OAAOvE,OAAP,CAAe,WAAf,EAA4BT,MAAMI,QAAN,CAAegC,KAA3C,CAA3D;;;AAGF,SAASuC,aAAT,GAAyB;QACjBzB,YAAN,CAAmBC,SAAnB,GAA+B,EAA/B;QACMD,YAAN,CAAmBpD,KAAnB,CAAyBgD,OAAzB,GAAmC,MAAnC;eACa,KAAb;;MAEI1C,WAAWoC,aAAf;MACIV,WAAWS,aADf;WAESJ,MAAT,GAAkB,UAAU8C,UAAUnD,QAAV,CAAV,GAAgC,QAAhC,GAA2CmD,UAAU7E,QAAV,CAA7D;MACIC,OAAJ,CAAY1B,MAAZ,EAAoByB,QAApB;WACS8E,KAAT,GAAiB9E,WAAW,MAAX,GAAoB0B,QAArC;;WAES9D,IAAT,CAAcmH,SAAd,CAAwB,mBAAmBF,UAAUnD,QAAV,CAAnB,GAAyC,QAAzC,GAAoDmD,UAAU7E,QAAV,CAA5E,EAAiGgF,IAAjG,CAAsG,UAACC,IAAD,EAAU;cACpGC,GAAGC,WAAH,CAAeF,KAAKG,MAApB,EAA4BH,KAAKI,SAAjC,CAAV;YACQnB,GAAR,CAAY,SAAZ,EAAuBtD,OAAvB;YACQwD,EAAR,CAAW,eAAX,EAA4B,UAAC/E,GAAD,EAAS;UAC/BiG,cAAcjG,IAAIkG,MAAJ,CAAWC,UAAX,CAAsBtI,IAAxC;cACQuI,SAAR,CAAkBpG,IAAIkG,MAAtB,EAA8B,QAA9B,EAAwC;0BACpB,IADoB;0BAEpB,KAFoB;oBAG1B;OAHd,EAIG,UAACG,GAAD,EAAMrG,GAAN,EAAc;YACZqG,GAAH,EAAO;kBACGjJ,KAAR,CAAc,qBAAd,EAAqCA,KAArC;SADF,MAGI;cACEkJ,MAAMtG,IAAIuG,OAAJ,CAAYhH,aAAZ,CAA0B,OAA1B,CAAV;kBACQsF,GAAR,CAAYoB,WAAZ,EAAyBK,GAAzB;cACIE,gBAAJ,CAAqBP,WAArB,EAAkCK,GAAlC;;OAXJ;KAFF;;YAkBQ1F,OAAR,CAAgBgF,KAAKa,KAArB,EAA4B,UAACrJ,KAAD,EAAW;UACjCA,KAAJ,EAAW;gBACDA,KAAR,CAAc,sBAAd,EAAsCA,KAAtC;OADF,MAEO;oBACOyI,GAAGa,aAAH,CAAiB,QAAjB,EAA2B;wBACvB,IADuB;wBAEvB,KAFuB;uBAGxB,IAHwB;gBAI/B/F,QAJ+B;iBAK9B;yBACQ,KADR;+BAEc,KAFd;0BAGS;;SARN,CAAZ;gBAWQgG,OAAR,CAAgBnF,SAAhB;;KAfJ;GArBF;;;"}