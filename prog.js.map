{"version":3,"file":null,"sources":["prog/index.js"],"sourcesContent":["if(!window.DEBUG){\r\n  console.warn = function(){};\r\n}\r\n\r\nfunction get(file, done) {\r\n  const x = new XMLHttpRequest();\r\n  x.onload = () => done(x.response);\r\n  x.onprogress = prog.thunk;\r\n  x.open(\"GET\", file);\r\n  x.send();\r\n}\r\n\r\nexport default prog = {\r\n  bar: null,\r\n  files: {},\r\n  loaded: 0,\r\n  total: 0,\r\n\r\n  thunk: (evt) => {\r\n    const file = evt.target.responseURL || evt.target.currentSrc;\r\n    if(file){\r\n      if(!prog.files[file]){\r\n        prog.files[file] = {};\r\n      }\r\n      const f = prog.files[file];\r\n      if(typeof evt.loaded === \"number\") {\r\n        f.loaded = evt.loaded;\r\n        f.total = evt.total;\r\n      }\r\n      else{\r\n        const bs = evt.srcElement.buffered;\r\n        let min = Number.MAX_VALUE,\r\n          max = Number.MIN_VALUE;\r\n        for(let i = 0; i < bs.length; ++i){\r\n          min = Math.min(min, bs.start(i));\r\n          max = Math.max(max, bs.end(i));\r\n        }\r\n        f.loaded = 1000 * max;\r\n        f.total = 1000 * evt.srcElement.duration;\r\n      }\r\n    }\r\n\r\n    let total = 0, loaded = 0;\r\n    for(const key in prog.files){\r\n      const f = prog.files[key];\r\n      loaded += f.loaded;\r\n      total += f.total;\r\n    }\r\n\r\n    prog.loaded = loaded;\r\n    prog.total = total;\r\n\r\n    if(!prog.bar){\r\n      prog.bar = document.querySelector(\"progress\");\r\n    }\r\n\r\n    if(prog.bar && total > 0){\r\n      prog.bar.max = total;\r\n      prog.bar.value = loaded;\r\n    }\r\n  }\r\n};\r\n\r\nconst curScripts = document.querySelectorAll(\"script\"),\r\n  curScript = curScripts[curScripts.length - 1];\r\n\r\nif(curScript && curScript.dataset.app) {\r\n  get(curScript.dataset.app, (contents) => {\r\n    const s = document.createElement(\"script\");\r\n    s.type = \"text/javascript\";\r\n    s.innerHTML = contents;\r\n    document.body.appendChild(s);\r\n  });\r\n}"],"names":["window","DEBUG","warn","get","file","done","x","XMLHttpRequest","onload","response","onprogress","prog","thunk","open","send","evt","target","responseURL","currentSrc","files","f","loaded","total","bs","srcElement","buffered","min","Number","MAX_VALUE","max","MIN_VALUE","i","length","Math","start","end","duration","key","bar","document","querySelector","value","curScripts","querySelectorAll","curScript","dataset","app","contents","s","createElement","type","innerHTML","body","appendChild"],"mappings":";;;AAAA,IAAG,CAACA,OAAOC,KAAX,EAAiB;UACPC,IAAR,GAAe,YAAU,EAAzB;;;AAGF,SAASC,GAAT,CAAaC,IAAb,EAAmBC,IAAnB,EAAyB;MACjBC,IAAI,IAAIC,cAAJ,EAAV;IACEC,MAAF,GAAW;WAAMH,KAAKC,EAAEG,QAAP,CAAN;GAAX;IACEC,UAAF,GAAeC,KAAKC,KAApB;IACEC,IAAF,CAAO,KAAP,EAAcT,IAAd;IACEU,IAAF;;;AAGF,YAAeH,OAAO;OACf,IADe;SAEb,EAFa;UAGZ,CAHY;SAIb,CAJa;;SAMb,eAACI,GAAD,EAAS;QACRX,OAAOW,IAAIC,MAAJ,CAAWC,WAAX,IAA0BF,IAAIC,MAAJ,CAAWE,UAAlD;QACGd,IAAH,EAAQ;UACH,CAACO,KAAKQ,KAAL,CAAWf,IAAX,CAAJ,EAAqB;aACde,KAAL,CAAWf,IAAX,IAAmB,EAAnB;;UAEIgB,IAAIT,KAAKQ,KAAL,CAAWf,IAAX,CAAV;UACG,OAAOW,IAAIM,MAAX,KAAsB,QAAzB,EAAmC;UAC/BA,MAAF,GAAWN,IAAIM,MAAf;UACEC,KAAF,GAAUP,IAAIO,KAAd;OAFF,MAII;YACIC,KAAKR,IAAIS,UAAJ,CAAeC,QAA1B;YACIC,MAAMC,OAAOC,SAAjB;YACEC,MAAMF,OAAOG,SADf;aAEI,IAAIC,IAAI,CAAZ,EAAeA,IAAIR,GAAGS,MAAtB,EAA8B,EAAED,CAAhC,EAAkC;gBAC1BE,KAAKP,GAAL,CAASA,GAAT,EAAcH,GAAGW,KAAH,CAASH,CAAT,CAAd,CAAN;gBACME,KAAKJ,GAAL,CAASA,GAAT,EAAcN,GAAGY,GAAH,CAAOJ,CAAP,CAAd,CAAN;;UAEAV,MAAF,GAAW,OAAOQ,GAAlB;UACEP,KAAF,GAAU,OAAOP,IAAIS,UAAJ,CAAeY,QAAhC;;;;QAIAd,QAAQ,CAAZ;QAAeD,SAAS,CAAxB;SACI,IAAMgB,GAAV,IAAiB1B,KAAKQ,KAAtB,EAA4B;UACpBC,KAAIT,KAAKQ,KAAL,CAAWkB,GAAX,CAAV;gBACUjB,GAAEC,MAAZ;eACSD,GAAEE,KAAX;;;SAGGD,MAAL,GAAcA,MAAd;SACKC,KAAL,GAAaA,KAAb;;QAEG,CAACX,KAAK2B,GAAT,EAAa;WACNA,GAAL,GAAWC,SAASC,aAAT,CAAuB,UAAvB,CAAX;;;QAGC7B,KAAK2B,GAAL,IAAYhB,QAAQ,CAAvB,EAAyB;WAClBgB,GAAL,CAAST,GAAT,GAAeP,KAAf;WACKgB,GAAL,CAASG,KAAT,GAAiBpB,MAAjB;;;CA9CN;;AAmDA,IAAMqB,aAAaH,SAASI,gBAAT,CAA0B,QAA1B,CAAnB;IACEC,YAAYF,WAAWA,WAAWV,MAAX,GAAoB,CAA/B,CADd;;AAGA,IAAGY,aAAaA,UAAUC,OAAV,CAAkBC,GAAlC,EAAuC;MACjCF,UAAUC,OAAV,CAAkBC,GAAtB,EAA2B,UAACC,QAAD,EAAc;QACjCC,IAAIT,SAASU,aAAT,CAAuB,QAAvB,CAAV;MACEC,IAAF,GAAS,iBAAT;MACEC,SAAF,GAAcJ,QAAd;aACSK,IAAT,CAAcC,WAAd,CAA0BL,CAA1B;GAJF;;;;;"}